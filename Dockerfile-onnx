# ── builder ────────────────────────────────────────────────
FROM eclipse-temurin:21-jdk AS builder
WORKDIR /build
COPY open-responses-server/build/libs/openresponses-onnx-0.4.0.jar openresponses-onnx-0.4.0.jar

# ── runtime ────────────────────────────────────────────────
FROM bellsoft/liberica-openjre-alpine:21
RUN apk add --no-cache libstdc++ libgcc

# security hardening
RUN addgroup -S app && adduser -S app -G app
USER app
WORKDIR /app

COPY --from=builder /build/openresponses-onnx-0.4.0.jar .
COPY open-responses-server/src/main/resources/mcp-servers-config.json .

ENTRYPOINT ["java", "-jar", "openresponses-onnx-0.4.0.jar"]
